<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.13.1 -->
<document source="/home/fbaumanis/openstack/soc8_test/openstack_repo/horizon/doc/source/admin/sessions.rst">
    <section ids="set-up-session-storage-for-the-dashboard" names="set\ up\ session\ storage\ for\ the\ dashboard">
        <title>Set up session storage for the Dashboard</title>
        <paragraph>The Dashboard uses <reference name="Django sessions framework" refuri="https://docs.djangoproject.com/en/dev/topics/http/sessions/">Django sessions
                framework</reference>
            to handle user session data. However, you can use any available session
            back end. You customize the session back end through the
            <literal>SESSION_ENGINE</literal> setting in your <literal>local_settings.py</literal> file.</paragraph>
        <paragraph>After architecting and implementing the core OpenStack
            services and other required services, combined with the Dashboard
            service steps below, users and administrators can use
            the OpenStack dashboard. Refer to the
            <reference internal="True" refuri="../user/index"><inline classes="doc">OpenStack User Documentation</inline></reference>
            chapter of the OpenStack End User Guide for
            further instructions on logging in to the Dashboard.</paragraph>
        <paragraph>The following sections describe the pros and cons of each option as it
            pertains to deploying the Dashboard.</paragraph>
        <section ids="local-memory-cache" names="local\ memory\ cache">
            <title>Local memory cache</title>
            <paragraph>Local memory storage is the quickest and easiest session back end to set
                up, as it has no external dependencies whatsoever. It has the following
                significant drawbacks:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>No shared storage across processes or workers.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>No persistence after a process terminates.</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>The local memory back end is enabled as the default for Horizon solely
                because it has no dependencies. It is not recommended for production
                use, or even for serious development work.</paragraph>
            <literal_block highlight_args="{}" language="python" linenos="False" xml:space="preserve">SESSION_ENGINE = 'django.contrib.sessions.backends.cache'
CACHES = {
  'default' : {
    'BACKEND': 'django.core.cache.backends.locmem.LocMemCache'
  }
}</literal_block>
            <paragraph>You can use applications such as <literal>Memcached</literal> or <literal>Redis</literal> for external
                caching. These applications offer persistence and shared storage and are
                useful for small-scale deployments and development.</paragraph>
            <section ids="memcached" names="memcached">
                <title>Memcached</title>
                <paragraph>Memcached is a high-performance and distributed memory object caching
                    system providing in-memory key-value store for small chunks of arbitrary
                    data.</paragraph>
                <paragraph>Requirements:</paragraph>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph>Memcached service running and accessible.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Python module <literal>python-memcached</literal> installed.</paragraph>
                    </list_item>
                </bullet_list>
                <literal_block highlight_args="{}" language="python" linenos="False" xml:space="preserve">SESSION_ENGINE = 'django.contrib.sessions.backends.cache'
CACHES = {
  'default': {
    'BACKEND': 'django.core.cache.backends.memcached.MemcachedCache',
    'LOCATION': 'my_memcached_host:11211',
  }
}</literal_block>
            </section>
            <section ids="redis" names="redis">
                <title>Redis</title>
                <paragraph>Redis is an open source, BSD licensed, advanced key-value store. It is
                    often referred to as a data structure server.</paragraph>
                <paragraph>Requirements:</paragraph>
                <bullet_list bullet="-">
                    <list_item>
                        <paragraph>Redis service running and accessible.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Python modules <literal>redis</literal> and <literal>django-redis</literal> installed.</paragraph>
                    </list_item>
                </bullet_list>
                <literal_block highlight_args="{}" language="python" linenos="False" xml:space="preserve">SESSION_ENGINE = 'django.contrib.sessions.backends.cache'
CACHES = {
    "default": {
        "BACKEND": "redis_cache.cache.RedisCache",
        "LOCATION": "127.0.0.1:6379:1",
        "OPTIONS": {
            "CLIENT_CLASS": "redis_cache.client.DefaultClient",
        }
    }
}</literal_block>
            </section>
            <section ids="initialize-and-configure-the-database" names="initialize\ and\ configure\ the\ database">
                <title>Initialize and configure the database</title>
                <paragraph>Database-backed sessions are scalable, persistent, and can be made
                    high-concurrency and highly available.</paragraph>
                <paragraph>However, database-backed sessions are one of the slower session storages
                    and incur a high overhead under heavy usage. Proper configuration of
                    your database deployment can also be a substantial undertaking and is
                    far beyond the scope of this documentation.</paragraph>
                <enumerated_list enumtype="arabic" prefix="" suffix=".">
                    <list_item>
                        <paragraph>Start the MySQL command-line client.</paragraph>
                        <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">$ mysql -u root -p</literal_block>
                    </list_item>
                    <list_item>
                        <paragraph>Enter the MySQL root user’s password when prompted.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>To configure the MySQL database, create the dash database.</paragraph>
                        <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">mysql&gt; CREATE DATABASE dash;</literal_block>
                    </list_item>
                    <list_item>
                        <paragraph>Create a MySQL user for the newly created dash database that has full
                            control of the database. Replace DASH_DBPASS with a password for the
                            new user.</paragraph>
                        <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">mysql&gt; GRANT ALL PRIVILEGES ON dash.* TO 'dash'@'%' IDENTIFIED BY 'DASH_DBPASS';
mysql&gt; GRANT ALL PRIVILEGES ON dash.* TO 'dash'@'localhost' IDENTIFIED BY 'DASH_DBPASS';</literal_block>
                    </list_item>
                    <list_item>
                        <paragraph>Enter <literal>quit</literal> at the <literal>mysql&gt;</literal> prompt to exit MySQL.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>In the <literal>local_settings.py</literal> file, change these options:</paragraph>
                        <literal_block highlight_args="{}" language="python" linenos="False" xml:space="preserve">SESSION_ENGINE = 'django.contrib.sessions.backends.db'
DATABASES = {
    'default': {
        # Database configuration here
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'dash',
        'USER': 'dash',
        'PASSWORD': 'DASH_DBPASS',
        'HOST': 'localhost',
        'default-character-set': 'utf8'
    }
}</literal_block>
                    </list_item>
                    <list_item>
                        <paragraph>After configuring the <literal>local_settings.py</literal> file as shown, you can run the
                            <literal_strong classes="command">manage.py syncdb</literal_strong> command to populate this newly created
                            database.</paragraph>
                        <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve"># /usr/share/openstack-dashboard/manage.py syncdb</literal_block>
                    </list_item>
                    <list_item>
                        <paragraph>The following output is returned:</paragraph>
                        <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve">Installing custom SQL ...
Installing indexes ...
DEBUG:django.db.backends:(0.008) CREATE INDEX `django_session_c25c2c28` ON `django_session` (`expire_date`);; args=()
No fixtures found.</literal_block>
                    </list_item>
                    <list_item>
                        <paragraph>To avoid a warning when you restart Apache on Ubuntu, create a
                            <literal>blackhole</literal> directory in the Dashboard directory, as follows.</paragraph>
                        <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve"># mkdir -p /var/lib/dash/.blackhole</literal_block>
                    </list_item>
                    <list_item>
                        <paragraph>Restart the Apache service.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>On Ubuntu, restart the <literal>nova-api</literal> service to ensure that the API server
                            can connect to the Dashboard without error.</paragraph>
                        <literal_block highlight_args="{}" language="console" linenos="False" xml:space="preserve"># service nova-api restart</literal_block>
                    </list_item>
                </enumerated_list>
            </section>
        </section>
        <section ids="cached-database" names="cached\ database">
            <title>Cached database</title>
            <paragraph>To mitigate the performance issues of database queries, you can use the
                Django <literal>cached_db</literal> session back end, which utilizes both your database
                and caching infrastructure to perform write-through caching and
                efficient retrieval.</paragraph>
            <paragraph>Enable this hybrid setting by configuring both your database and cache,
                as discussed previously. Then, set the following value:</paragraph>
            <literal_block highlight_args="{}" language="python" linenos="False" xml:space="preserve">SESSION_ENGINE = "django.contrib.sessions.backends.cached_db"</literal_block>
        </section>
        <section ids="cookies" names="cookies">
            <title>Cookies</title>
            <paragraph>If you use Django 1.4 or later, the <literal>signed_cookies</literal> back end avoids
                server load and scaling problems.</paragraph>
            <paragraph>This back end stores session data in a cookie, which is stored by the
                user’s browser. The back end uses a cryptographic signing technique to
                ensure session data is not tampered with during transport. This is not
                the same as encryption; session data is still readable by an attacker.</paragraph>
            <paragraph>The pros of this engine are that it requires no additional dependencies
                or infrastructure overhead, and it scales indefinitely as long as the
                quantity of session data being stored fits into a normal cookie.</paragraph>
            <paragraph>The biggest downside is that it places session data into storage on the
                user’s machine and transports it over the wire. It also limits the
                quantity of session data that can be stored.</paragraph>
            <paragraph>See the Django <reference name="cookie-based sessions" refuri="https://docs.djangoproject.com/en/dev/topics/http/sessions/#using-cookie-based-sessions">cookie-based
                    sessions</reference>
                documentation.</paragraph>
        </section>
    </section>
</document>
